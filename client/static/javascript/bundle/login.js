(()=>{"use strict";class e extends Element{setClass(...e){for(let t of e)this.classList.add(t);return this}setId(e){return this.id=e,this}setText(e){return this.innerText=e,this}setHTML(e){return this.innerHTML=e,this}}function t(e,t){let n=document.createElement(e,t);for(let e in t.attributes)n.setAttribute(e,t.attributes[e]);for(let e of t.classes)n.classList.add(e);return t.id&&(n.id=t.id),n}let n,i,s,o,a;async function r(e){console.log(e),"collect"===e.action&&async function(e){if(n.innerText=e.message,i.innerText=e.header,o.innerHTML="","email"===e.type){let e=t("input",{attributes:{type:"email",placeholder:"Email",required:!0},classes:[],id:""});o.appendChild(e);let n=async t=>{t.preventDefault(),l({value:e.value}),s.removeEventListener("submit",n)};s.addEventListener("submit",n)}else if("binary"===e.type){let e=t("input",{attributes:{type:"checkbox",required:!0},classes:[],id:""});o.appendChild(e);let n=async t=>{t.preventDefault(),l({value:e.checked}),s.removeEventListener("submit",n)};s.addEventListener("submit",n)}}(e)}async function l(e){fetch("/api/login/return",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,...e})}).then((async e=>{let t=await e.json();console.log(t),r(t)}))}Object.getOwnPropertyNames(e.prototype).forEach((t=>{"constructor"!==t&&(Element.prototype[t]=e.prototype[t])})),window.addEventListener("load",(e=>{const t=window.PublicKeyCredential&&navigator.credentials&&"function"==typeof navigator.credentials.create&&"function"==typeof navigator.credentials.get;n=document.getElementById("collection-message"),i=document.getElementById("collection-header"),s=document.getElementById("collection-form"),o=document.getElementById("collection-inputs"),fetch("/api/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supportsWebAuthn:t})}).then((async e=>{let t=await e.json();a=t.id,console.log(t),r(t)}))}))})();